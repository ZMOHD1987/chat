<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ask Shjmun</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f7;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            width: 90%;
            margin: 20px auto;
            padding: 20px;
            background: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #e0f0d9;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
            font-size: 16px;
        }
        button {
            padding: 12px 25px;
            margin: 10px 5px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #45a049;
        }
        #chatHistory {
            border: 1px solid #ddd;
            background-color: #fafafa;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            border-radius: 5px;
            margin-top: 20px;
        }
        h2 {
            margin: 0;
            color: #4CAF50;
        }
        .lang-switch {
            display: flex;
            gap: 10px;
        }
        .chat-entry {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            margin-bottom: 10px;
        }
        .chat-entry:last-child {
            border-bottom: none;
        }
        .chat-entry strong {
            color: #4CAF50;
        }
        .rtl .chat-entry {
            text-align: right;
            direction: rtl;
        }
        .ltr .chat-entry {
            text-align: left;
            direction: ltr;
        }
        @media (max-width: 600px) {
            button {
                width: 100%;
                margin: 5px 0;
            }
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            .lang-switch {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2 id="title">Ask Shjmun</h2>
            <div class="lang-switch">
                <button onclick="setLanguage('ar')">ุงูุนุฑุจูุฉ</button>
                <button onclick="setLanguage('en')">English</button>
            </div>
       </div>
        <input type="text" id="searchField" placeholder="ุฃุฏุฎู ูุตุทูุญ ุงูุจุญุซ" list="questionsList">
        <datalist id="questionsList">
            <!-- Arabic default responses will be loaded here -->
        </datalist>
        <button id="generateButton">ุงุฑุณุงู</button>
        <button id="clearButton">ูุณุญ</button>
        <button id="voiceInputButton">๐ค</button>
        <div id="chatHistory" class="rtl"></div>
    </div>

 </div>

    <script>
        const texts = {
            ar: {
                title: "Ask Shjmun",
                placeholder: "ุฃุฏุฎู ูุตุทูุญ ุงูุจุญุซ",
                send: "ุงุฑุณุงู",
                clear: "ูุณุญ",
                defaultResponses: {
                    "ูู ุงูุช": "ุฃูุง ุฐูุงุก ุงุตุทูุงุนู ูููุณุงุนุฏุฉ.",
                    "ูุฑุญุจุง": "ูุฑุญุจุง! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ",
                    "ุงูุณูุงู ุนูููู": "ูุนูููู ุงูุณูุงู! ููู ูููููู ูุณุงุนุฏุชูุ",
                    "ุณูุงู": "ุณูุงู! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ",
                    "ูุง ุนููู": "ุฃูุง ููุง ูุฃุณุงุนุฏู ูู ุงูุนุซูุฑ ุนูู ุงููุนูููุงุช ุงูุชู ุชุญุชุงุฌูุง.",
                    "ูู ุตููู": "ุชู ุชุตูููู ูู ูุจู ูุฑูู ุงูุชุทููุฑ ุจุฅุฏุงุฑุฉ ุงูุฑูุงุจุฉ ูุงูุณูุงูุฉ ุงูุตุญูุฉ.",
                    "ุงููุง": "ุงููุง! ููู ูููููู ูุณุงุนุฏุชู ุงููููุ",
                    "ููู ุญุงูู": "ุฃูุง ุจุฎูุฑุ ุดูุฑูุง! ููู ูููููู ูุณุงุนุฏุชูุ",
                    "ูููู": "ุฃูุง ุจุฎูุฑุ ุดูุฑูุง! ููู ูููููู ูุณุงุนุฏุชูุ"
                },
                answers: [
                    { name: "ุฎุงูุฏ ุงูุญูุงุฏู", role: "ุฑุฆูุณ ูุณู ุฑูุงุจุฉ ุงูุฃุบุฐูุฉ" },
                    { name: "ูุญูุฏ ุงูุณููุฏู", role: "ุฑุฆูุณ ุดุนุจุฉ ุงูุงุณุชูุฑุงุฏ ูุงูุชุตุฏูุฑ" },
                    { name: "ุนูู ุณูููุงู", role: "ุฑุฆูุณ ุดุนุจุฉ ุชูุชูุด ุงูููุดุขุช ุงูุบุฐุงุฆูุฉ" },
                    { name: "ุตุงูุญ ุงูุณููุฏู", role: "ูุณุคูู ูุญุฏุฉ ุงูุชุฑุฎูุต" },
                    { name: "ุตุงูุญ ุงูุณููุฏู", role: "ูุณุคูู ูุญุฏุฉ ุงููุตุงูุน" },
                    { name: "ุจุฏุฑ ูุงุตุฑ", role: "ูุณุคูู ูุญุฏุฉ ุงูุฏุฑุงุณุงุช" },
                    { name: "ุจุฏุฑ ูุงุตุฑ", role: "ูุณุคูู ูุญุฏุฉ ุงููุฒุงุฑุน" },
                    { name: "ุฌูุงู ุงููุงุฒูู", role: "ูุฏูุฑ ุฅุฏุงุฑุฉ ุงูุฑูุงุจุฉ ูุงูุณูุงูุฉ ุงูุตุญูุฉ" },
                    { name: "ุนุงุฏู ุนูุฑ", role: "ูุฏูุฑ ูุทุงุน ุงูุตุญุฉ ุงูุนุงูุฉ ูุงููุฎุชุจุฑุงุช ุงููุฑูุฒูุฉ" },
                    { name: "ูุญูุฏ ุงูุฌุณูู", role: "ุธุงุจุท ุฅุฏุงุฑู" },
                    { name: "ูุญูุฏ ุงูุฌุณูู", role: "ุฑุฆูุณ ูุฑูู ุงูุชุทููุฑ" },
                    { key: "ุชุฑุฎูุต ูุทุนู", text: "ุงุดุชุฑุงุทุงุช ุงูุชุฑุฎูุต - ุฃููุงูุ ุงุณุชุฎุฑุงุฌ ุงูุงุณู ุงูุชุฌุงุฑู ูู ุงูุชูููุฉ ุงูุงูุชุตุงุฏูุฉ ููุฑุงุฌุนุฉ ูุณู ุงูุฑูุงุจุฉ ุงูุบุฐุงุฆูุฉ ุจุงููุงุตุฑูุฉ ูุน ุงููุณุชูุฏุงุช ุงูุขุชูุฉ: ุงูุงุณู ุงูุชุฌุงุฑูุ ุณูุฏ ุงูููููุฉุ ุฎุงุฑุทุฉ ุงูุฃุฑุถุ ุงููุฎุทุท ุงูููุฏุณู ููุจูุงุกุ ูุงูููุงู ุจุญุฌุฒ ููุนุฏ ููุชูุชูุด ูู ูุจู ุงูููุชุด." },
                    { key: "ุงูุฑุณูู", text: "250 ุฏุฑูู ุงูู ูู 50 ูุชุฑ ูุฑุจุน ู500 ุฏุฑูู ุงูุซุฑ ูู 50 ูุชุฑ ูุฑุจุน ุฑุณูู ูุนุงููุฉ 200 ุฏุฑูู ููู ูุนุงููุฉ ููููุดุฃุฉ." },
                    { key: "ุฅุฌุฑุงุกุงุช ุชุฑุงุฎูุต ุงูููุดุขุช ุงูุบุฐุงุฆูุฉ", text: [
                        "ุงุณุชุฎุฑุงุฌ ุงูุงุณู ุงูุชุฌุงุฑู + ุงููุณุชูุฏุงุช ุงููุทููุจุฉ.",
                        "ุงูุชูุชูุด ุนูู ุงูููุดุขู.",
                        "ุนูู ูุฎุทุท ููุตู ููููุดุฃุฉ.",
                        "ุงูุชูููุน ุนูู ุชุนูุฏ.",
                        "ุฅุตุฏุงุฑ ุงูููุงููุฉ ุงูููุงุฆูุฉ.",
                        "ุชุญุฑูุฑ ุงูุชุตุฑูุญ ุงูุตุญู."
                    ] }  // New key added with numbered list
                ],
                questionList: [
                    "ูู ุงูุช",
                    "ูุฑุญุจุง",
                    "ุงูุณูุงู ุนูููู",
                    "ุณูุงู",
                    "ูุง ุนููู",
                    "ูู ุตููู",
                    "ุงููุง",
                    "ููู ุญุงูู",
                    "ูููู",
                    "ุฅุฌุฑุงุกุงุช ุชุฑุงุฎูุต ุงูููุดุขุช ุงูุบุฐุงุฆูุฉ"  // New entry added
                ]
            },
            en: {
                title: "Ask Shjmun",
                placeholder: "Enter search term",
                send: "Send",
                clear: "Clear",
                defaultResponses: {
                    "who are you": "I am an AI assistant.",
                    "hello": "Hello! How can I help you today?",
                    "peace be upon you": "Peace be upon you! How can I assist you?",
                    "peace": "Peace! How can I help you today?",
                    "what's your job": "I am here to assist you in finding the information you need.",
                    "who designed you": "I was designed by the development team at the Food Safety and Control Administration.",
                    "hi": "Hi! How can I help you today?",
                    "how are you": "I'm fine, thank you! How can I help you?",
                    "how you doing": "I'm fine, thank you! How can I help you?",
                    "how are you doing": "I'm fine, thank you! How can I help you?"
                },
                answers: [
                    { name: "Khalid Al Hamadi", role: "Head of Food Control Department" },
                    { name: "Mohammed Al Suwaidi", role: "Head of Import and Export Division" },
                    { name: "Ali Suleiman", role: "Head of Food Establishments Inspection Division" },
                    { name: "Saleh Al Suwaidi", role: "Licensing and Factories Unit Manager" },
                    { name: "Badr Nasser", role: "Studies Unit Manager" },
                    { name: "Jamal Al Mazmi", role: "Director of Food Safety and Control Department" },
                    { name: "Adel Omar", role: "Director of Public Health and Central Laboratories Sector" },
                    { key: "restaurant license", text: "License requirements - First, obtain the trade name from the Economic Development, then visit the Food Control Department at Al Nasseriah with the following documents: trade name, property deed, land map, building plan, and book an inspection appointment with the inspector." },
                    { key: "fees", text: "250 AED for less than 50 square meters, 500 AED for more than 50 square meters, 200 AED inspection fee for each inspection." },
                    { key: "Food Establishment Licensing", text: [
                        "Obtain a commercial name + required documents.",
                        "Inspection of the establishment.",
                        "Prepare detailed plans for the establishment.",
                        "Sign an undertaking.",
                        "Issue final approval.",
                        "Issue health permit."
                    ] }  // New key added with numbered list
                ],
                questionList: [
                    "who are you",
                    "hello",
                    "peace be upon you",
                    "peace",
                    "what's your job",
                    "who designed you",
                    "hi",
                    "how are you",
                    "how you doing",
                    "how are you doing",
                    "Food Establishment Licensing"  // New entry added
                ]
            }
        };
        let currentLanguage = 'ar';

        function setLanguage(language) {
            currentLanguage = language;

            document.getElementById('title').innerText = texts[language].title;
            document.getElementById('searchField').placeholder = texts[language].placeholder;
            document.getElementById('generateButton').innerText = texts[language].send;
            document.getElementById('clearButton').innerText = texts[language].clear;

            const chatHistory = document.getElementById('chatHistory');
            chatHistory.className = language === 'ar' ? 'rtl' : 'ltr';
            
            // Update the datalist options
            const questionsList = document.getElementById('questionsList');
            questionsList.innerHTML = '';
            texts[language].questionList.forEach(question => {
                const option = document.createElement('option');
                option.value = question;
                questionsList.appendChild(option);
            });

            recognition.lang = language === 'ar' ? 'ar' : 'en-US';
        }

        function normalizeArabic(text) {
            return text.replace(/[\u064B-\u0652\u0670]/g, '') // Remove all diacritics
                       .replace(/[\u0621-\u0622\u0623\u0624\u0625\u0626\u0627]/g, 'ุง') // Normalize different forms of Alef
                       .replace(/[\u0649\u064A]/g, 'ู') // Normalize Yaa
                       .replace(/[\u0648\u0624]/g, 'ู') // Normalize Waw
                       .replace(/[\u0647\u0629]/g, 'ู'); // Normalize Haa and Taa Marbuta
        }

        function normalizeEnglish(text) {
            return text.toLowerCase(); // Convert all letters to lowercase
        }

        function extractInfo(question) {
    question = currentLanguage === 'ar' ? normalizeArabic(question.toLowerCase().trim()) : normalizeEnglish(question.toLowerCase().trim());
    const langTexts = texts[currentLanguage];

    // ุงูุจุญุซ ูู ุงูุฅุฌุงุจุงุช ุงูุงูุชุฑุงุถูุฉ
    for (const key in langTexts.defaultResponses) {
        if (question.includes(currentLanguage === 'ar' ? normalizeArabic(key.toLowerCase()) : normalizeEnglish(key.toLowerCase()))) {
            return [langTexts.defaultResponses[key]];
        }
    }

    // ุงูุจุญุซ ูู ุงูุฅุฌุงุจุงุช ุงููุนุฑูุฉ ูุณุจูุงู
    let results = [];
    langTexts.answers.forEach(answer => {
        if (answer.name && question.includes(currentLanguage === 'ar' ? normalizeArabic(answer.name.split(" ")[0].toLowerCase()) : normalizeEnglish(answer.name.split(" ")[0].toLowerCase()))) {
            results.push(`${answer.name} ${currentLanguage === 'ar' ? "ูู" : "is"} ${answer.role}`);
        } else if (answer.role && question.includes(currentLanguage === 'ar' ? normalizeArabic(answer.role.toLowerCase()) : normalizeEnglish(answer.role.toLowerCase()))) {
            results.push(`${answer.role} ${currentLanguage === 'ar' ? "ูู" : "is"} ${answer.name}`);
        } else if (answer.key && question.includes(currentLanguage === 'ar' ? normalizeArabic(answer.key.toLowerCase()) : normalizeEnglish(answer.key.toLowerCase()))) {
            if (Array.isArray(answer.text)) {
                // ุฅุฐุง ูุงู ุงููุต ุนุจุงุฑุฉ ุนู ูุตูููุฉุ ูู ุจุฏูุฌ ุงููุตูุต ููุตููุง ุจุนูุงูุฉ ุฌุฏูุฏุฉ
                results.push(answer.text.map((line, index) => `${index + 1}. ${line}`).join('<br>'));
            } else {
                results.push(answer.text);
            }
        }
    });

    if (results.length === 0) {
        results.push(currentLanguage === 'ar' ? "ูุง ุชูุฌุฏ ูุชุงุฆุฌ ูุทุงุจูุฉ." : "No matching results.");
    }

    return results;
}

        document.getElementById('generateButton').onclick = function () {
            const question = document.getElementById('searchField').value;
            const chatHistory = document.getElementById('chatHistory');

            const responses = extractInfo(question);
            const responseHtml = responses.map(response => `<div class="chat-entry answer"><strong>${currentLanguage === 'ar' ? 'ุฅุฌุงุจุฉ' : 'Answer'}:</strong> ${response}</div>`).join('');

            chatHistory.innerHTML += `<div class="chat-entry"><strong>${currentLanguage === 'ar' ? 'ุณุคุงู' : 'Question'}:</strong> ${question}</div>`;
            chatHistory.innerHTML += responseHtml;
            chatHistory.scrollTop = chatHistory.scrollHeight;
        };

        document.getElementById('clearButton').onclick = function () {
            document.getElementById('searchField').value = '';
            document.getElementById('chatHistory').innerHTML = '';
        };

        // ุฅุถุงูุฉ ุฏุนู ูุชุญููู ุงูุตูุช ุฅูู ูุต
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        document.getElementById('voiceInputButton').onclick = function () {
            recognition.start();
        };

        recognition.onresult = function (event) {
            const transcript = event.results[0][0].transcript;
            document.getElementById('searchField').value = transcript;
        };

        recognition.onspeechend = function () {
            recognition.stop();
        };

        recognition.onerror = function (event) {
            console.error('Error occurred in recognition: ' + event.error);
        };

        setLanguage('ar');
    </script>
</body>
</html>